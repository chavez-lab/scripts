#!/bin/bash

## DO NOT EDIT THIS FILE. Please copy it for your needs. ##

#SBATCH --nodes=1 # All cores on one machine
#SBATCH --account=csd677 # DO NOT CHANGE
#SBATCH --partition=shared
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=8
#SBATCH -t 0-12:00 # Runtime in D-HH:MM
#SBATCH --mem=12G # Memory pool for all cores
#SBATCH -o slurm-%x-%j.out # File to which STDOUT will be written
#SBATCH --job-name=fasterq-dump
#SBATCH --mail-type=FAIL # Type of email notification- BEGIN,END,FAIL,ALL
#SBATCH --mail-user=ochapman@ucsd.edu # Email to which notifications will be sent
### Set this to the working directory
#SBATCH -D .

# Submit this sbatch job with eg.
# sbatch fasterq-dump.sbatch SRR8639212 DAOY

#################################
# Run your code below this line #
#################################

SRR=$1
OUTDIR=${2:-fastq}
SCRATCH=/expanse/lustre/scratch/ochapman/temp_project/

#/expanse/lustre/projects/csd677/collab/bin/sratoolkit.2.11.3-ubuntu64/bin/fasterq-dump
source ~/.bashrc

fasterq-dump --outdir $OUTDIR --mem $SLURM_MEM_PER_NODE  --split-3 --threads $SLURM_CPUS_PER_TASK --skip-technical --print-read-nr \
	-t $SCRATCH $SRR
gzip $OUTDIR/${SRR}_1.fastq
gzip $OUTDIR/${SRR}_2.fastq
